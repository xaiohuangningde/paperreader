# DeepSpec Pro v2.0 演示指南

## 新功能概述

DeepSpec Pro v2.0 已从"能运行的脚本"升级为"好用的生产力工具"，主要新增功能包括：

1. **Word报告生成器**：自动生成符合您要求的5列表格结构Word文档
2. **图片裁剪工具**：从PDF中精确截取关键图表
3. **LaTeX公式渲染**：将数学公式转换为图片嵌入Word文档
4. **结构化数据提取**：更精准地提取论文关键信息

## 快速开始

1. **安装依赖**：
   ```bash
   pip install -r requirements.txt
   ```

2. **运行应用**：
   ```bash
   streamlit run app.py
   ```

## 使用流程

### 1. 上传PDF并分析

- 在左侧边栏上传SPE论文PDF
- 选择您的专家角色
- 输入OpenAI API密钥
- 点击"AI 分析"按钮

### 2. 编辑提取内容

- 在中间区域查看并编辑AI提取的内容
- 可以修改论文标题、研究目的、结论等
- 支持编辑多组结论和公式

### 3. 裁剪关键图表

- 在右侧区域选择要裁剪的PDF页面
- 使用图片裁剪工具精确选择关键图表
- 将裁剪的图片添加到报告中

### 4. 添加到Word报告

- 完成编辑后，点击"将此条目添加到Word报告"
- 可以添加多篇论文到同一个报告中
- 在底部查看已添加的论文列表

### 5. 生成Word文档

- 点击"生成 Word 报告"按钮
- 等待系统生成Word文档
- 点击"下载 Word 报告"按钮下载文档

## Word文档结构

生成的Word文档包含以下结构：

| 列 | 内容 |
|---|---|
| Article | 论文标题 |
| 具体内容(1) | 研究目的与核心结论 |
| 具体内容(2) | 详细参数、公式(图片形式)和关键图表 |
| Comments | 您的想法和批注 |
| Why | 标签和分类 |

## 高级功能

### 1. 图片裁剪

支持两种裁剪方式：
- **自动裁剪**：使用streamlit-cropper库（需安装）
- **手动裁剪**：使用滑块精确控制裁剪区域

### 2. LaTeX公式渲染

系统会自动将LaTeX公式渲染为图片，确保在Word中正确显示。

### 3. 批量处理

可以添加多篇论文到同一个报告中，生成综合性的文献综述。

## 示例输出

生成的Word文档示例：

```
SPE 文献深度分析报告

生成时间: 2023年12月15日 14:30
注: 本报告由 DeepSpec Pro 自动生成，结论与参数均源自原文。

--------------------------------------------------

| Article | 具体内容(1): 目的与结论 | 具体内容(2): 参数与公式 | Comments (想法) | Why |
|---------|-------------------------|-------------------------|-----------------|-----|
| Achieving Uniform Proppant Distribution... | 1. 研究目的：<br>采用CFD-EGM模型研究支撑剂在射孔簇中的分布...<br><br>2. 核心结论：<br>(1) 倒数第二簇支撑剂浓度最高<br>(2) 增加注入速率能减少底部沉降... | 1. 详细参数：<br>• 网格类型: 四面体+六面体<br>• 支撑剂: 40/70目<br><br>2. 核心公式：<br>[公式图片]<br><br>3. 关键图表：<br>[图表图片] | 这篇论文的网格划分策略值得参考... | CFD, Proppant Transport |
```

## 故障排除

1. **图片裁剪失败**：确保已安装streamlit-cropper库：`pip install streamlit-cropper`

2. **Word生成失败**：检查python-docx库是否正确安装

3. **LaTeX渲染问题**：如果公式渲染不正确，会显示为LaTeX源码

## 更新日志

### v2.0.0 (2023-12-15)
- 新增Word报告生成器
- 新增图片裁剪功能
- 新增LaTeX公式渲染
- 优化UI交互体验
- 重构数据处理流程